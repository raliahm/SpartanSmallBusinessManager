<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Business View</title>
  <link rel="stylesheet" href="student.css" >
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
</head>
<body>
<div id="navbar-container"></div>
<div id="content">
  <div class="input-group mb-3">
    <input type="text" id="search-bar" class="form-control" placeholder="Search Business by Name" aria-label="Search Business">
  </div>
  </div>
  <div id="buttons">
    <button type="button" class="btn btn-primary" id="delete-btn">Delete Business</button>
    <button type="button" class="btn btn-primary" id="restrict-btn">Restrict Business</button>
    <button type="button" class="btn btn-primary" id="unrestrict-btn">Unrestrict Business</button>

  </div>
  <div id="list-students">
    <table class="table">
      <thead class="thead-dark">
      <tr>
        <th scope="col">#</th>
        <th scope="col">Name</th>
        <th scope="col">Owner</th>
        <th scope="col">ID</th>
        <th scope="col">Status</th>

      </tr>
      </thead>
      <tbody id="table-body">
      <tr data-name="Spartan Cooks">
        <th scope="row">1</th>
        <td>Spartan Cooks</td>
        <td>Otto</td>
        <td>@mdo</td>
        <td><span class="status">Active</span></td>
      </tr>
      <tr data-name="Target">
        <th scope="row">2</th>
        <td>Target</td>
        <td>Thornton</td>
        <td>@fat</td>
        <td><span class="status">Active</span></td>

      </tr>
      <tr data-name="Walmart">
        <th scope="row">3</th>
        <td>Walmart</td>
        <td>the Bird</td>
        <td>@twitter</td>
        <td><span class="status">Active</span></td>

      </tr>
      </tbody>
    </table>

  </div>


</div>

<!-- Bootstrap JS -->

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
<script>
  fetch('navbar.html')
          .then(response => response.text())
          .then(data => {
            document.getElementById('navbar-container').innerHTML = data;
          })
          .catch(error => console.error('Error loading navbar:', error));  // To catch any fetch errors
  //for filtering table rows
  document.getElementById('search-bar').addEventListener('input', function () {
    let filter = this.value.toLowerCase();
    let rows = document.querySelectorAll('#table-body tr');
    rows.forEach(row => {
      let nameCell = row.cells[1].textContent.toLowerCase();
      if (nameCell.includes(filter)) {
        row.style.display = '';
      } else {
        row.style.display = 'none';
      }
    });
  });

  //deleting a business
  document.getElementById('delete-btn').addEventListener('click', function () {
    let searchValue = document.getElementById('search-bar').value.toLowerCase();
    let rows = document.querySelectorAll('#table-body tr');
    let deleted = false;

    rows.forEach(row => {
      let name = row.getAttribute('data-name').toLowerCase();
      let statusCell = row.querySelector('.status');
      let status = statusCell ? statusCell.textContent.toLowerCase() : '';

      // Only delete if status is not "restricted" and name matches search query
      if (name.includes(searchValue) && status  == "restricted") {
        row.remove();
        deleted = true;
      }
    });

    if (deleted == false) {
      alert("No active business found with that name.");
    }
  });
  //restrict a business
  document.getElementById('restrict-btn').addEventListener('click', function () {
    let searchValue = document.getElementById('search-bar').value.toLowerCase();
    let rows = document.querySelectorAll('#table-body tr');
    let restricted = false;

    rows.forEach(row => {
      let name = row.getAttribute('data-name').toLowerCase();
      if (name.includes(searchValue)) {
        let statusCell = row.querySelector('.status');
        statusCell.textContent = "Restricted";
        statusCell.style.color = "red"; // Change status color to indicate restriction
        restricted = true;
      }
    });

    if (!restricted) {
      alert("No business found with that name.");
    }
  });

  //unrestrict a business
  document.getElementById('unrestrict-btn').addEventListener('click', function () {
    let searchValue = document.getElementById('search-bar').value.toLowerCase();
    let rows = document.querySelectorAll('#table-body tr');
    let restricted = true;

    rows.forEach(row => {
      let name = row.getAttribute('data-name').toLowerCase();
      if (name.includes(searchValue)) {
        let statusCell = row.querySelector('.status');
        statusCell.textContent = "Active";
        statusCell.style.color = "black"; // Change status color to indicate restriction
        restricted = false;
      }
    });

    if (!!restricted) {
      alert("No business found with that name.");
    }
  });
</script>
</body>

</html>

